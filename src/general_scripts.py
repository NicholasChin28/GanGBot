from codecs import encode
from botocore.exceptions import ClientError
import psycopg2
from dotenv import load_dotenv
import os
import io
import asyncpg
import concurrent.futures
import time
import pathlib
import boto3
import botocore
import re
import json
import logging
from pydub import AudioSegment
from tortoise import Tortoise, run_async
from yaml import parse
from Models.aws_s3 import AwsS3
import asyncio
from youtube_dl import YoutubeDL
from aiohttp import ClientSession
import pydub
from mutagen.mp3 import MP3
import mutagen
from pyaml_env import parse_config
from tortoise import Tortoise, run_async
from src.Models.playsound import Playsound
from src.Models.role import Role
from io import BytesIO

load_dotenv()

async def init():
    tortoise_config = parse_config('./tortoise-config.yaml')
    await Tortoise.init(config=tortoise_config)

    await Tortoise.generate_schemas()

    item = await Role.filter(id=3)
    print(item[0].guild)
    
    full_list = await Role.first()
    print(full_list.guild)

    # Insert value into playsound table
    """
    await Playsound.create(
        name='test',
        duration=18.000,
        uploader=12739182,
        played=0,
        guild=81823,
    )
    """

    playsounds = await Playsound.all()
    for ps in playsounds:
        print(ps.duration)


# run_async(init())
bytesio_object = BytesIO(br'ID3\x04\x00\x00\x00\x00\x00#TSSE\x00\x00\x00\x0f\x00\x00\x03Lavf58.45.100\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xfb\x94\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00Info\x00\x00\x00\x0f\x00\x00\x02E\x00\x03\xac\x80\x00\x02\x05\x07\n\r\x0f\x11\x14\x17\x1a\x1b\x1e #&),.0357:=@BEHKNPRUXZ]_behiloqsvy|~\x81\x83\x85\x88\x8a\x8d\x90\x92\x95\x97\x9a\x9c\x9f\xa2\xa4\xa7\xa9\xac\xaf\xb1\xb4\xb5\xb8\xba\xbd\xbf\xc2\xc5\xc7\xca\xcc\xce\xd1\xd3\xd6\xd9\xdb\xde\xe1\xe3\xe6\xe7\xea\xed\xf0\xf2\xf4\xf7\xf9\xfc\x00\x00\x00\x00Lavc58.91\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\xac\x80?\x00\x92\xf4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xfb\x94@\x00\x00\x02H\x07Q\xfd$\x00\x08O\x84*/\xa4\x8c\x00\x0b\xc4Sy\xf8\xf7\x90\x11i\no\x7f\x1e\xc0\x00p\x97"C\x12\x12IH\xb5@\x18o\xf8\x80pL\xd2\x82\xb2}Q\x00\x0c,\x0f\xa9a\xf1\x19\xf9w\x83\xf8|\xb9\xfe\x1f\xe5\xcf\xcb\xbc\x1f\xc9\x97|\xbb\xc3\xfbK\xbf\x87\xf2\xe5\xcf\xcb\xbc?\x87\xcb\xbe]\xe1\xfa\xc1\xf2\xe7\xeb~\xb0\xff/\xd6\x1fYu\x102\x10\x12\x8aI7@\xd99\x10\x00d\x07\x04\xcf\xa0\x04\xc9\xf5D\x196\xe0\x06,\xe1n\xf0\x0cY\xfe\xe7\x00\xc5\x9a\x15w\xdd\xff\xfd\x1d\xf4\'w\x80b\xcf\xeb\x0f\x88\xcf\xcb\x9f\'\xf9u\x03\xf8>\\\xff\xf2\xef\xad\xe1\xfc>]\xffX}yw\x87\xe5\xc1\xf0\x015Dv9sU6R\x9a\xb18cM\x99\r3,\xb1\xceC\xb90\x19\x03\xe8\xfdL \x04T\xe2\x11\xd40R\xe1\x1f\x8b\xe2z\xdcM\x89\xb3r\xe9\xc6<\x14\xfb+\x14\x08\x0f\xab%\xe0\xbd\x8aQ\xe9]!\x07(\x19-x\xaeU\xabKn\xa9\x9a\xf5\xd8\x8e\xa4>\xc5;\xde\xab\xb1\xef\xf8ad5\x99\xdbJ\x89C>]\xcc\xc5C\xc3\xbcq\xa0\xdb\xb6k6\xc5\xbc\xbd\x92y\xc8\xaa\x8fA\xfcA\xdcK$<\x94\x92\x02\xc6b\xa4Fb@/P0|\x06\xc9\xc5\xa4\xeb\xc4\xf9\xa9\x05c\x0f\'\xd5\xcb\xeb\x01\xf3\xe1\x02\xedX\xe0\xb3MQ\xa3\xb1=\xfae\xd5\xa1\xccB\x9f\xbe\xc5V\xa7j\xbb[\xfd\x01\x8f\xbb\xd2(9+m\xa4\xa3D\x96>]\x9f\xff\xfb\x94@\x05\x80\x01\xc4\t^o<\x00\x0c7\xc1\x0b\xdf\xe6\x00\x01\x07p\xe3q\xe7\x88K`\xe6\rn\xfc\xd2\x89$\xa8\xcf\xda6\xfd\x0fq\xbb\xc8v\xdc\x1e5\xf3\xcd:>\xbe5A\x94\xca\x06\xab\x8br1UeX\xe6/\xfe\x93\nuz/\xff\xefI\xed\x1a]\xf92@`\x88\x88\x11h\x94\xd4\x94\x11VU4\x99H!\xcc\xbd\x1fQ+\xf3\xa7\xcek3Ywm\xee\xd6\xeb\x13\xc5\xfb5\x1e\xd3\xcb6\x90\xd4\xe5{\x9c9)v\xbf\xbd?\xa5\xa8\x7f\x86\xc4B\x19\xd5\xd9\x91Y\xb5\x8d\xe0BF\x8a\x81\xfc\xf7\x99\xe2\xb1\xaew\x064\x13\xdfZ\xf3\xd5?\xcc\x9f\xcd\xea\xda\x13\xb2\xbf\xb5\xb7_\xf9R\xa9\xb7\xff\xf6\xb0\xeb\x1f\xeaj\xdb\xed\xfe\rw@\x05\x1f\xa4\x8c\x10!\x9dDQ$\xb8\xdd\x021&\x1br\x88\xd1\x81Ne\t\x8b\x9do\x9f\xf0m\xd7\'\xeb\xfc~K\x9c\xd4\xfc\xbeD-\x9f\x0c\xde\xb4>\x98\xff\x93\xd4\x8d\xa3\xb3\xb4,)\xdd\xa8\x0bb@$Ke\x95\xdd\xd2\xd8\x134\x82\xb3#\xb5\x0b\xa6ft\xd8]\xf6\xb5\x1c\x92\xa7:\xba7\xfaO\xba\xff\xf7M\xab\xffB?\xf5\xa9=\xff\xfa\'\xe7k\x197\xfd\x89\x7f\xfbB/%\x89\xca3S\x00\xa3\x9f\xb4\x89\x88(J\xa3\x90\xa2QI\xbc\n\xd9\x01H\xea\x1arM\xb2i\xf7\xa1M\t\xfa\x93\xf0\xff\x83\xeb\xf3\xba_\x9e\xd4GS\xb1^\x14\xf4\x85\x13\xd0a\xf6v6\xbdov\xb5\\F\xd6_R\xa4L5C\xc43\xaa\xaa\xab*\xff\xfb\x94@@\x80\x01\xf5G\xdee0@\x0c8\x02\xeb\xcf\xa6\x88\x01\x0c\x0cqy\xf8\xf6\x00\x01V\x0bo?\x1e\xb0\x00\x03\x1a\xb2k>\xa3\xe2)J\xf8\xcc\x18\xc3\x80\xd3\x1c\xa6Q\xcc\x1c\x84\x8d\x9c|\x93\xd2B[\x80|n\x81\xf0\xe9\x04\xa8;\xd8x0RYBnh\xb3\xaa|\xdb\rRsg\xb7\xfag&:\xa3_\x9e.\x86\x93\xbd6\xe7iK\x90\x8fs\x0f\x10\xf3\x85-[\xb9\x06\xb5\x8f\xd7\xbd\xbbiT\x97x\x87\x86fvb3m\x12[M)n\xd4W0Ml7\x8dq\x84\xb6Y\xbd\x13\xe5r\xf9N{\x98\xca\xd2o\x01\x9c\n\x9e+`\x8e[\x90/>!\x9c\xa3K\xb2\xbf(\xadm\xa8\x16z\x1bT\x92\xe4\xbb\xe8B\xb8\x80\xb7G#\x9eMO\xc6.\xca\xd6K+\xaf\x9e\xdc\xf9P\xa7\x95dC2\x12J-\xb9\x95\x8bl\x1f\x87\xe2ED\xe2J\xf3Z\xb7.\xc6\x0c\x03\x06\xdd I\xcfb\xb5\n\xb9\xb5,\x06\x9a\x85\xeb"\xeb\x0c\xbf#\xb4a\x04\xb9))Z\xc1GYS\xdaUt\x87+c\x1c\x81c|c(h\xa2\xd2\xc1Z\xf6e\x96\x19\x90@\x92\xe4\xbb\xf1\xc0Up\x94\xc1\xd3\x80y.\xc4\x85\x83m\xb7R)Q\xff"\xfc\r\x9b\xf3\xf6\xa9\xd6\xa7\x85\xf4\xab\x00\xf46\x9d\x94\xd8\xb8a\x94\x08\x1dP\xb3aLq\xcd\x8f\xc0\x8d\x1e9\xd8\xa5\xe4\xf9\xa1\x91\x95\x08D\x92\x8br\xe3\x91B\x1a\x087^d\x03\x89VD\x86\x0e,\x84\x98\x1aY\x82\x8f\xbc\x83^\x81\xa2\xaf\x8c\xff\xfb\x94@X\x00\x02R\x08]\xff0\x00\x08A\x02[\xcf\xe4\x88\x00\x08\xd8#w\xe6$d\xa0\xf4\x10n|\xc2\x89(\x9b\xf7?\xa5*2\xb5\xf7T\xb4\x00^h\xc4\\y\x86\x8b\x05\xe5Gjt\xee(oa\'X/-\xb1\xef\xe8\xf8\xc8\xbaW\x11\x00II\xbbU\n\x8d\r\x88\x03\xb0\xf0Z1hH5\x82\xc5\x8dMM\xf4\x13\xfc\x02n\x80\x9b\xdc+\xfd\x1f\xf1\t\x8a\x1f\xc9jw\xfc\x0e\xfd\xec\xad\xda\xf5\xf4t5e\xdf\xf0\xd6\x8b\xe8\xe8ddB\x11"\x92)\xb9\x98\x0e\xc4\xb1\xd0\x1f4\'\x07^\x15\x0eaE\xd8hH\xa3\xd2O"m\xe2T%\x84\x84\xe2\xc0\xd4b\xebC\xd2\xf9\xdb4\x1f\x18C\xc3%\x18\x04\x8a\x8b$b\x08X\xb0ed\x9a\xe7XuJ[\xef\xf4=\x1d\x08\x18\xe2\xc8\xe8\xa7\t\xa81\x11\xa5\'\x16\x0f\x03\xbb\x84#2i\x1aer\xb2\x88$\x1aO\x9a[\xf2O\xf0\xdb\xfcn\xdeVv\xf10d\xf1\x05\xfb\x87\x97\xda\xde0U>\x7f\xdf\xf4\xfc\x9at/\xc6\x8e\xc7>]\xbf\xf4=\x0bf\x96j\xa4d2!\x00\x10I\x04\xa5\r\x03\xb1\x02\x00\xc86H\x0e\tO\x97\x97\x07F\xe6\xb0\xec\x14xTB\x19As\xa1\x93\xa9\x05\xc3 &\x13\x0c\xa5\xa4\x9a\xd6(\xd3\xb2\xa7\x1e\x0b\xc8\xee\xd0X%\xb4s\xde\x0c\x90YS\x01\x17\x8a\xd3i5P\xeb\xa8{\x88\xa1\x89\x98\xd8\xa8\xcfzP\x92\x01\x12%$\x89PJ\x02\x8aB(\xc0!\x18O\xf4\xc9\xf0\xef\xa0\xb7\xe3\xa3\x17\xd2\xff\xfb\x94@~\x80\x02`\x07\xdc\xf9\x890\xa8C\x08\x0b\x9e0\xe5]\n0+k\xe4\xa4\xc4\xa1\'\x1b.<\x93\x95l\x18\x7fP"\xfc]\xdb\xc6\x8f\xfb\x91\xd6\xea\x8b\')[\x90<R\xadh\x9d\x90\x8e\xd5\xd4u\x14\xe9\xea^%\xca3\x91Z\x93\x8b>\xa2\xd5\xb9\xabb\xc0\xb5Fa\x11\x112Q)\'Q\n\x96\x8d\x87\x86\x94\x07c\xfa\xc7\x15\xb5\x12\xa2\x94\xc7>\x19z\xc6\x02!r\xa5\xdc"8\x18\x05\x03\xed\x036a.1&\xa7\xa2\xf0\xd4\xc9\xa0\xd0\xb3\xcd\x1dk\xeb\xb1\x8b\x00)kR\xdc\xea\xefL\x93\xc5\xd3 \xe7\xd9\xb8\xda\xc9\'\x8d\xd5\x94\x07\x10\x01\x12\x8am\xc9A\x10P\x1f2\x0f\xccV/\xfa\x16\x1a1\xf2\x81\xb7\xf4#\xf3\xc5\xe6nPf\xf8\x13\xea\xc3\xfc\x81\x14\xf9\x0f\xad\x86\x11\xbc@\xbe\x887\xe36\xec5\xb9Mn\xde\x96\'\xa3W!\xac\xcb\xd0\x9dnz\xc7\xe3\x1a\xa2\x88\x89\x11I\x14\x9d\xa3\xc9lr(\t\x95;\x1eU\x99\xd82\xd6\xd9%\xcd>c6j\x1f\xfc\xe1\xb3c\xf81\xda\xa1\xae\x9aeg\x80\xe3\xc0 U\xb2\xba\x90\x03\x130\x80\xd4X\xe8\x1b}\x0e\x01\xa9\x89I\xfd\xa8\xae\x978\xbbg\xa2\xc9/{\xe6k;\xa1Z=\xe1AH\x08\x04YE\xd5\x0e\xe9\x88\x88\x88c[S:\x8aP\x88\x9f<]\xf4\x02\xff`B\xfa(\xb5}\x04\xb3\xbd$~\xc2L\xda\xab\xfe\x85m\x10$\x8f\xe6\x14\xec\xae\x19\xe97\xd1\x95m_\xe7\xbff\xfd[\xe7\xa7\x8d\xe4\xd3}\xf2\xff\xfb\x94@\x97\x00\x02\x80\n[y\x8c\x19(F&\xbbo$\xe5Z\n$im\xe6\x18\xc9!(\'-\xb8\xc3\x95\xb4h\xc6\x80\x80\xc56!\x12\x11"I$\x95L\x07\xd5\x03\xaa1\x80\xeaB`\x9e\x1c\xc2\tO\xb4\x8dH\xad\xe9\xbaOH:\x0c\xe4\xed\xa0\x9fPB-wz|\xf8\x9f[;~;\xffyE0\xe8\xe8\xe3\x8e(\xd9bC\x1cUm\x85\xdc\xdb\x8d\x9fJ\x96\xf5\'-\x94l\xa1\xcan?F9\x08\x19\xbd\n\x15\xf5\x84\x07 \x11\x15e\x17dR\\(\x1d\n\x07\x97&St\x89\xc6\xbf*E\xf2\xa3/\x94\x016N\x9f\xc7\x94\xb6\x13:\x9d\x11\x06~^\xd8\x91\t\xe7#\xf9\x83;J9\xbd\x1b\xe9\xa9\x9b6\x9b\xb3\xe8\xa9Zv\xf4\x91\xba\xc5\x1f\x15}\xa0\x96\xf9\xbbvA\x021\x11$\x92ARF\x82Q\x00K\x84K\xa2t/\x1c\xf1\x06\xc3\xb5Vwt;\xa6\x10K\xa9\xaa\xb8P\x83\xc5<\x86\x11\x03\xc0\xc8\x06\xa7\xc4d\xa5\xc5/uD\x9aI\xe7m\tT\xba\x1c\xfd\xce\xd6\xf7\xa6\xd1\xe6\xda\xb3}3\xdb=H\x9a\xa7\xe2\xd1\xdcL\x08ET\x1cz\x1c\x9e\x16\xbaFZ>\x16\x16\x1eG\x89\x03\xf7\x7f\xe4\x08\x8b\x8fD\xac!yw\xe4HA\xc0\xc5\xf9\x9as\xe8\x019\x9c\x10s\xf7+\xa2\\\xfe\x157\x1a\xc9\xb0Q\x9f2\xe8\x93\xb4N\x8a\x85QZ\xe6Bv*\xa6o\xcb\x9bm@\'\xb1\xacda\xa2\x02D,\x85$\x00\x942!\x11\x11\x15j\xaf\x16\x8f\x82Q)P\xbc\xff\xfb\x94@\xac\x00\x02\xc0"Zy\x862XJ\x89\xdb^1Em\t\x88am\xe6\x18i!f\x17\xad\xb8\xc4\rl\xc6N.s\x05\xe4\xa42\xba\xccN\xbe?:3\xd6ly\xda\xdc\xc9*\x99\xdd\xa7\xf7\xd3\xb9\xc1\xaa\x98\xc0\x8e$\xf6FC\xb1L`o\x98\xff[BU4{\xfb?\xe8\xbd\xda\xdd\xb5\xf9\xed8\xbe\x06t\xf2\x84\x8fXi\x8d\xbd\n\xeb\xe9\xb2\x06\x12\x01\x12JI\xb7\x18\x1c\xc4!\xde\x83\x93a<\xcb\xcb\xde\x07=\xa3\xfe"\x19\xd4\xee\xdfTJ\xb6f\x85\x02(\xeef_o\xc6\xd8|\xb5\xb5]7MB\xf2\x91\xd7w7\x1c=\xccW=d|qiF$\xc8\xab\x83q8AGZ\xf6\x05\x84\xf4\x97\x86^\xb1\xce\x9e\xb5\xfd\x17\xa1K[W^\xc4\x11\x99\x08\x88\x8b(\xb8,\x19\x0f\x8c\x84\x83P\x01N\x92\x1aP@\xe3/H@\xafB\xbb\xc3\x14\xc9\xf8\x97 \x88bc\xb2\xb4\xb6Vw\x9e\xc8ZII\xe41\xdd\x1a\xbb\xcf\xf4\xaf\xbb\x7f\xf7z=\t\xb2\xbd\x14z\x1e\x03\n\x98 1\x88\x80*\x02;\xfbG\xf8\x9c\t\xaf\x02\x0c\x86b\x05$\x9br\x0e\xa4\x94\x837\x86\xb9\x10&Q#0\xc1\x01B\xf3 \x18\xff\xb3|\x08+_!\xd1\xa8GQ\xfd\x01\x04g\xeeQn\xba\x02!\'tH\xb1\xc7\x8d\x82\x87\xcc\x80\xc5v\xd4\xe2N\xd21+\xb8U\x86\x8f;Pf\xc4\x1e\xee\xcb\xb5\x17\x94h\xb0\x84\x12"2!\x15V\xaa\x06\xc7@p\xe1\x18\x16li\x00a9\xec\x92\x16\xfaHN\xcc\x9aP\x96\xff\xbd\xafU\xab\xd24\xe2\xf9\xde\xa4\x10i\xc88>\xec\xe4C\xc6\x99\xd1\xab\x07\xe8\x87]\xd0\x87\xfd+V\xd1\x1a\xa3*\x01\x14\x92NH\xb8\x1d\\#\11\xfa\x98%?r~\x8br\xa9`\x8c\xaf@\xb2e\xa5\x0e\x99\x1a\xa4\xc2\x08\x11\x91\x11\n\xd5U](\xf4\xb65\x0f-\xfc\xa2Y(J\x1e\x9er\xda\xff\xdb\xfc\xb3\xf4u\xcc\x10Ot\xc1\xf8\xf8\x1e8a\xc2\xd7bA\x10\xe4\xbbz\xe7h4\xbe\x96\xdf\x8a\xfb\xf9\xf9\xff\xfe\xeb\xfe\xff\x8f\x88!\xeeQU7D\xfe\x87\xc4\xcf\xa8\xc6\xd7i\x87}\xbf?,\xf8\xc1XQ\x1223\x12j\xba\xa7\xa8\xd6\xd3\x8aB\x9a\xd06\xb9u\x17*8\xf69\xe5\xf7\xde[\xa5X\xc1\xf3]\xc4\x014c\x07\xc5\xd9\xc5\x06\x18I\xdc@\x04\x16%\xce\xd1\xa8d\x15\x13\x91\x9dT\x84\xa3\x91\x96\xab\xfd\xdb\xdf\xa7Q1\xd9\nRNBnv\xf50\xd6Em1\xe9\xfe\xe9g\xc6\n\x80\xf5\x11\x11\x13"%\xa5\x05H\xae6\x867\x08\x97\x87\xd3\xff\xfb\x94@\xb9\x80\x02\xb5D\xddq&*\xe4\\\x89;\x9f0\xa3l\n\xcd\x11y\xc7\x8d\x0b\x91^\xa2/x\xf3\x95r>\xb9\xcbY\xbb\xa5S\xa0{O\x99\x91\x94\xbb\xb2\xdd\xd16u\xb8\xec\x1e\xaa\x1d\xc5\xe0o\x8f\x14\t\xc5D\xab\xb8\xb8&\x13\x954\xd1y\xe8\x87\x9eK\x95\x16\x06\x8fb,\xf9\x0f\x9e\xbf\xb4\xedgOzd\x03\xc0\xb84\x99\xcb\x93\xb4\xd1\xf91\xb9\xee{\xd1\xdfF\x8d\x0f "\x1a\x11\xa7\xf7\xeb\xb5\xff\xedT{|\x8eLLL\xcc\x08Yi\xa8"Q\x0139\xb1\x0')

print(bytesio_object)

# Write
with open("supertest", "wb") as f:
    f.write(bytesio_object.getbuffer())



